% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FuncCTRDBStratifiedAnalysis.R
\name{analyzeStratifiedCTRDB}
\alias{analyzeStratifiedCTRDB}
\title{Stratified analysis for CTRDB clinical data}
\usage{
analyzeStratifiedCTRDB(
  drug_b_name,
  drug_a_name,
  select_omics,
  connection,
  top_n_genes = 100,
  data_type = "all",
  tumor_type = "all",
  min_response_size = 3,
  min_non_response_size = 3,
  meta_enabled = TRUE
)
}
\arguments{
\item{drug_b_name}{Name of drug B used for signature generation}

\item{drug_a_name}{Name of drug A for signature application}

\item{select_omics}{Character string specifying the omics feature name to analyze in drug A}

\item{connection}{CTRDB database connection object}

\item{top_n_genes}{Number of top genes to select from each dataset (default: 100)}

\item{data_type}{Filter by data type ("all", "CellLine", "PDO", "PDC", "PDX")}

\item{tumor_type}{Filter by tumor type ("all" or specific tumor types)}

\item{min_response_size}{Minimum samples required in response group (default: 3)}

\item{min_non_response_size}{Minimum samples required in non-response group (default: 3)}

\item{meta_enabled}{Logical, whether to perform meta-analysis (default: TRUE)}
}
\value{
A list containing analysis results, plots, and signature genes
}
\description{
Performs stratified analysis on CTRDB data to identify drug response signatures
and analyze the correlation between specific omics features and the signature scores.
Each patient's B drug signature is calculated using their own top upregulated genes.
}
\examples{
\dontrun{
# Connect to CTRDB database first
con <- connectCTRDatabase("path/to/ctrdb.sqlite")

# Perform stratified analysis with specific omics feature
result <- analyzeStratifiedCTRDB(
  drug_b_name = "Cisplatin",
  drug_a_name = "Paclitaxel",
  select_omics = "EGFR",
  connection = con
)

# View signature genes
result$signature_genes

# View comprehensive correlation comparison plot
result$correlation_results$comprehensive_plot

# View correlation data
result$correlation_results$meta_data

# View meta-analysis forest plot
result$meta_analysis$forest_plot
}
}
